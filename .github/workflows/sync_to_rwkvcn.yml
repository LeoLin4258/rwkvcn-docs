name: Sync Docs to RWKVCN

on:
  push:
    branches:
      - main

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout RWKVCN-DOCS repo
        uses: actions/checkout@v2

      - name: Sync Docs to RWKVCN
        env:
          PERSONAL_ACCESS_TOKEN: ${{ secrets.SYNC_DOCS_TOKEN }}
        run: |
          # 克隆 RWKVCN 仓库的 docs 分支
          git clone --branch docs https://$SYNC_DOCS_TOKEN@github.com/leo4258/rwkvcn.git rwkvcn

          # 使用 rsync 将 RWKVCN-DOCS 仓库的 pages 目录同步到 RWKVCN 仓库的 pages 目录
          rsync -av --delete --exclude='.git' pages/ rwkvcn/pages/

          # 提交并推送更新到 RWKVCN 的 docs 分支
          cd rwkvcn
          git add pages/
          git commit -m "Sync pages directory from RWKVCN-DOCS main to docs"
          git push origin rwkvcn-docs
